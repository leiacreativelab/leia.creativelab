{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/LeiaCreativeLab/app/api/contact/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { Resend } from \"resend\";\r\n\r\nexport const runtime = \"nodejs\";            // √©viter Edge\r\nexport const dynamic = \"force-dynamic\";     // pas de pr√©-rendu\r\n\r\nfunction getResend() {\r\n  const key = process.env.RESEND_API_KEY;\r\n  // Ne jette PAS d'erreur au chargement du module: on check √† l'ex√©cution.\r\n  return new Resend(key);\r\n}\r\n\r\nexport async function POST(req: NextRequest) {\r\n  try {\r\n    const { name, email, message } = await req.json();\r\n\r\n    if (!process.env.RESEND_API_KEY) {\r\n      // R√©ponse propre si la cl√© manque en runtime\r\n      return NextResponse.json(\r\n        { ok: false, error: \"RESEND_API_KEY manquante c√¥t√© serveur\" },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    const resend = getResend();\r\n\r\n    // --- Mail admin\r\n    const { error: adminErr } = await resend.emails.send({\r\n      from: process.env.RESEND_FROM!,      // ex: \"contact@ton-domaine.com\"\r\n      to: process.env.RESEND_TO!,          // ta bo√Æte\r\n      replyTo: email,                      // ‚úÖ (camelCase)\r\n      subject: `üì© Nouveau message ‚Äî ${name ?? \"Anonyme\"}`,\r\n      html: `\r\n        <h2>Nouveau message</h2>\r\n        <p><strong>Nom :</strong> ${name ?? \"‚Äî\"}</p>\r\n        <p><strong>Email :</strong> ${email ?? \"‚Äî\"}</p>\r\n        <p><strong>Message :</strong></p>\r\n        <p>${(message ?? \"\").replace(/\\n/g, \"<br/>\")}</p>\r\n      `,\r\n    });\r\n    if (adminErr) throw adminErr;\r\n\r\n    // --- Accus√© de r√©ception utilisateur (optionnel)\r\n    if (email) {\r\n      const { error: userErr } = await resend.emails.send({\r\n        from: process.env.RESEND_FROM!,\r\n        to: email,\r\n        subject: \"‚úÖ Nous avons bien re√ßu votre message\",\r\n        text:\r\n          `Bonjour ${name ?? \"\"},\\n\\n` +\r\n          `Merci pour votre message. Nous revenons vers vous tr√®s vite.\\n\\n` +\r\n          `‚Äî Le√Øa Creative Lab`,\r\n      });\r\n      if (userErr) throw userErr;\r\n    }\r\n\r\n    return NextResponse.json({ ok: true });\r\n  } catch (e: any) {\r\n    console.error(\"Email error:\", e);\r\n    return NextResponse.json({ ok: false, error: e?.message ?? \"error\" }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;AAEO,MAAM,UAAU,UAAqB,cAAc;AACnD,MAAM,UAAU,iBAAqB,mBAAmB;AAE/D,SAAS;IACP,MAAM,MAAM,QAAQ,GAAG,CAAC,cAAc;IACtC,yEAAyE;IACzE,OAAO,IAAI,oJAAM,CAAC;AACpB;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,IAAI;QAE/C,IAAI,CAAC,QAAQ,GAAG,CAAC,cAAc,EAAE;YAC/B,6CAA6C;YAC7C,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,IAAI;gBAAO,OAAO;YAAwC,GAC5D;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,SAAS;QAEf,iBAAiB;QACjB,MAAM,EAAE,OAAO,QAAQ,EAAE,GAAG,MAAM,OAAO,MAAM,CAAC,IAAI,CAAC;YACnD,MAAM,QAAQ,GAAG,CAAC,WAAW;YAC7B,IAAI,QAAQ,GAAG,CAAC,SAAS;YACzB,SAAS;YACT,SAAS,CAAC,qBAAqB,EAAE,QAAQ,WAAW;YACpD,MAAM,CAAC;;kCAEqB,EAAE,QAAQ,IAAI;oCACZ,EAAE,SAAS,IAAI;;WAExC,EAAE,CAAC,WAAW,EAAE,EAAE,OAAO,CAAC,OAAO,SAAS;MAC/C,CAAC;QACH;QACA,IAAI,UAAU,MAAM;QAEpB,kDAAkD;QAClD,IAAI,OAAO;YACT,MAAM,EAAE,OAAO,OAAO,EAAE,GAAG,MAAM,OAAO,MAAM,CAAC,IAAI,CAAC;gBAClD,MAAM,QAAQ,GAAG,CAAC,WAAW;gBAC7B,IAAI;gBACJ,SAAS;gBACT,MACE,CAAC,QAAQ,EAAE,QAAQ,GAAG,KAAK,CAAC,GAC5B,CAAC,gEAAgE,CAAC,GAClE,CAAC,mBAAmB,CAAC;YACzB;YACA,IAAI,SAAS,MAAM;QACrB;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;QAAK;IACtC,EAAE,OAAO,GAAQ;QACf,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAO,OAAO,GAAG,WAAW;QAAQ,GAAG;YAAE,QAAQ;QAAI;IACtF;AACF","debugId":null}}]
}